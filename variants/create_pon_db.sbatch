#!/bin/bash
#
# pipeline
#SBATCH -c 20
#SBATCH --mem 70g
#SBATCH --mail-type=ALL
# Assumes all of these tools are availble on the command line or using the conda environments provided

declare -a normals=("SRR6059542" "SRR6059543" "SRR6059546" "SRR6059547" "SRR6059550" "SRR6059551" "SRR6059552" "SRR6059553" "SRR6059558" "SRR6059559" "SRR6059562" "SRR6059563" "SRR6059566" "SRR6059567" "SRR6059568" "SRR6059569" "SRR6059574" "SRR6059575" "SRR6059578" "SRR6059579" "SRR6059582" "SRR6059583" "SRR6059584" "SRR6059585" "SRR6059590" "SRR6059591" "SRR6059592" "SRR6059593" "SRR6059596" "SRR6059597" "SRR6059602" "SRR6059603" "SRR9623678" "SRR9623679" "SRR9623682" "SRR9623683" "SRR9623686" "SRR9623687" "SRR9623690" "SRR9623691" "SRR9623694" "SRR9623695" "SRR9623698" "SRR9623699" "SRR9623702" "SRR9623703" "SRR9623706" "SRR9623707" "SRR9623710" "SRR9623711" "SRR9623714" "SRR9623715" "SRR9623718" "SRR9623719" "SRR9623722" "SRR9623723" "SRR9623726" "SRR9623727" "SRR9623730" "SRR9623731" "SRR9623734" "SRR9623735")

source ~/.bashrc

conda activate variant_calling

gatk --java-options "-Xmx70G" GenomicsDBImport -R $FASTA -L $GENCODE_v34_INTERVAL_LIST \
--genomicsdb-workspace-path pondb \
--sample-name-map $SAMPLE_NAME_MAP \
--TMP_DIR $TMPDIR

gatk --java-options "-Xmx70G" CreateSomaticPanelOfNormals -R $FASTA \
-V gendb://pondb \
-O pon.vcf.gz
